<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistente Interactivo de Procesos de Compra</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony -->
    <!-- Application Structure Plan: The SPA is designed as an interactive "Implementation Assistant" dashboard. This structure was chosen over a linear document view to make the content actionable and engaging for the user (an Admin Manager). The user can explore key areas via a top navigation bar. Key interactive elements include: a clickable P2P flowchart to explain the process steps, an interactive software comparison chart, a dynamic policy generator where users can adjust approval limits with sliders, and a visual implementation timeline. This task-oriented design helps the user build and understand their new procurement process, rather than just reading about it. -->
    <!-- Visualization & Content Choices: 
        - P2P Workflow (Part II): Goal: Organize/Inform. Method: Clickable step-flow diagram (HTML/CSS). Interaction: Clicking a step reveals details and RACI roles. Justification: More engaging and visual than a static list.
        - Software Comparison (Part IV): Goal: Compare. Method: Radar chart (Chart.js). Interaction: Buttons to select tools to compare, updating the chart. Justification: Provides a quick, multi-criteria visual comparison.
        - Approval Policy (Part V): Goal: Interact/Inform. Method: Sliders for monetary thresholds linked to a dynamic bar chart. Interaction: User adjusts sliders, and the policy visualization updates in real-time. Justification: Turns a static policy into a hands-on configuration tool.
        - Implementation Plan (Part VI): Goal: Organize/Change. Method: Vertical timeline with expandable phases (HTML/CSS). Interaction: Clicking a phase reveals detailed tasks. Justification: Breaks down the plan into manageable steps.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .nav-link {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-link.active, .nav-link:hover {
            color: #2563eb; /* blue-600 */
            border-bottom-color: #2563eb; /* blue-600 */
        }
        .step-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .step-card:hover, .step-card.active {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            border-color: #2563eb; /* blue-600 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="text-slate-800">

    <div id="app" x-data="appData()" x-cloak>
        <header class="bg-white shadow-sm sticky top-0 z-20">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center">
                        <i data-lucide="shield-check" class="h-8 w-8 text-blue-600"></i>
                        <h1 class="ml-3 text-xl font-bold text-slate-900">Asistente de Procesos de Compra</h1>
                    </div>
                    <nav class="hidden md:flex items-center space-x-4">
                        <a href="#filosofia" @click="activeSection = 'filosofia'" :class="{'active': activeSection === 'filosofia'}" class="nav-link font-medium text-slate-600 py-2 px-1">Filosofía</a>
                        <a href="#flujo" @click="activeSection = 'flujo'" :class="{'active': activeSection === 'flujo'}" class="nav-link font-medium text-slate-600 py-2 px-1">Flujo P2P</a>
                        <a href="#arquetipos" @click="activeSection = 'arquetipos'" :class="{'active': activeSection === 'arquetipos'}" class="nav-link font-medium text-slate-600 py-2 px-1">Arquetipos</a>
                        <a href="#herramientas" @click="activeSection = 'herramientas'" :class="{'active': activeSection === 'herramientas'}" class="nav-link font-medium text-slate-600 py-2 px-1">Herramientas</a>
                        <a href="#politica" @click="activeSection = 'politica'" :class="{'active': activeSection === 'politica'}" class="nav-link font-medium text-slate-600 py-2 px-1">Política</a>
                        <a href="#implementacion" @click="activeSection = 'implementacion'" :class="{'active': activeSection === 'implementacion'}" class="nav-link font-medium text-slate-600 py-2 px-1">Implementación</a>
                    </nav>
                </div>
            </div>
        </header>

        <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

            <!-- Section: Filosofia -->
            <section id="filosofia" class="mb-16 scroll-mt-20">
                <h2 class="text-3xl font-bold text-slate-900 mb-2">Del Caos a la Claridad</h2>
                <p class="text-lg text-slate-600 mb-8 max-w-3xl">La clave para una startup no es la burocracia, sino un sistema inteligente que equilibre agilidad y control. Este asistente le guiará para implementar un proceso que sirva a su equipo, no al revés.</p>
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center mb-4">
                            <i data-lucide="swords" class="h-8 w-8 text-blue-600"></i>
                            <h3 class="ml-4 text-xl font-semibold">El Dilema: Agilidad vs. Control</h3>
                        </div>
                        <p class="text-slate-600">Un proceso rígido anula la velocidad. La falta de proceso acelera el gasto. La solución es un marco tecnológico con controles automatizados en tiempo real.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center mb-4">
                            <i data-lucide="users" class="h-8 w-8 text-blue-600"></i>
                            <h3 class="ml-4 text-xl font-semibold">Filosofía Ágil</h3>
                        </div>
                        <p class="text-slate-600">Priorice la colaboración con proveedores, la flexibilidad y la iteración. El proceso debe ser intuitivo y empoderar a los empleados dentro de límites claros.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center mb-4">
                            <i data-lucide="rocket" class="h-8 w-8 text-blue-600"></i>
                            <h3 class="ml-4 text-xl font-semibold">Proceso Mínimo Viable (MVPP)</h3>
                        </div>
                        <p class="text-slate-600">Comience de forma sencilla con controles críticos: aprobación previa, límites de gasto y un registro centralizado. El proceso evolucionará con la empresa.</p>
                    </div>
                </div>
            </section>

            <!-- Section: Flujo P2P -->
            <section id="flujo" class="mb-16 scroll-mt-20">
                <h2 class="text-3xl font-bold text-slate-900 mb-2">Flujo de Trabajo Interactivo de Adquisición y Pago (P2P)</h2>
                <p class="text-lg text-slate-600 mb-8 max-w-3xl">Explore el ciclo de vida de una compra. Haga clic en cada paso para ver los detalles, el propósito y quién es responsable (matriz RACI).</p>
                
                <div class="relative">
                    <div class="hidden md:block absolute top-1/2 left-0 w-full h-0.5 bg-slate-300 -translate-y-1/2"></div>
                    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 relative">
                        <template x-for="(step, index) in p2pSteps" :key="index">
                            <div @click="activeStep = (activeStep === index) ? null : index" 
                                 class="step-card bg-white p-4 rounded-lg shadow border-2"
                                 :class="{'active': activeStep === index, 'border-transparent': activeStep !== index}">
                                <div class="flex flex-col items-center text-center">
                                    <div class="bg-blue-100 text-blue-600 rounded-full h-12 w-12 flex items-center justify-center font-bold text-xl mb-3" x-text="index + 1"></div>
                                    <h4 class="font-semibold text-sm" x-text="step.title"></h4>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <div x-show="activeStep !== null" x-transition class="mt-8 bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-2xl font-bold mb-4" x-text="p2pSteps[activeStep]?.title"></h3>
                    <p class="text-slate-600 mb-6" x-text="p2pSteps[activeStep]?.description"></p>
                    <div class="bg-slate-50 p-4 rounded-md">
                        <h4 class="font-semibold text-lg mb-3">Roles y Responsabilidades (RACI)</h4>
                        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 text-center">
                            <div>
                                <p class="font-bold text-slate-500 text-sm">Jefe de Depto.</p>
                                <span class="font-bold text-2xl" :class="raciColor(p2pSteps[activeStep]?.raci.solicitante)" x-text="p2pSteps[activeStep]?.raci.solicitante"></span>
                            </div>
                            <div>
                                <p class="font-bold text-slate-500 text-sm">Finanzas</p>
                                <span class="font-bold text-2xl" :class="raciColor(p2pSteps[activeStep]?.raci.finanzas)" x-text="p2pSteps[activeStep]?.raci.finanzas"></span>
                            </div>
                            <div>
                                <p class="font-bold text-slate-500 text-sm">Gestor Admin.</p>
                                <span class="font-bold text-2xl" :class="raciColor(p2pSteps[activeStep]?.raci.gestor)" x-text="p2pSteps[activeStep]?.raci.gestor"></span>
                            </div>
                            <div>
                                <p class="font-bold text-slate-500 text-sm">CEO/Liderazgo</p>
                                <span class="font-bold text-2xl" :class="raciColor(p2pSteps[activeStep]?.raci.ceo)" x-text="p2pSteps[activeStep]?.raci.ceo"></span>
                            </div>
                        </div>
                         <p class="text-xs text-slate-500 mt-4 text-center">R: Responsable, A: Aprobador, C: Consultado, I: Informado</p>
                    </div>
                </div>
            </section>

            <!-- Section: Arquetipos -->
            <section id="arquetipos" class="mb-16 scroll-mt-20">
                <h2 class="text-3xl font-bold text-slate-900 mb-2">Explorador de Arquetipos de Gasto</h2>
                <p class="text-lg text-slate-600 mb-8 max-w-3xl">No todos los gastos son iguales. Un proceso flexible se adapta a las necesidades únicas de cada departamento. Descubra la solución ideal para cada caso.</p>
                <div class="grid md:grid-cols-3 gap-8">
                    <template x-for="archetype in archetypes" :key="archetype.id">
                        <div class="bg-white rounded-lg shadow overflow-hidden">
                            <div class="p-6">
                                <div class="flex items-center mb-4">
                                    <i :data-lucide="archetype.icon" class="h-10 w-10 text-blue-600"></i>
                                    <h3 class="ml-4 text-xl font-semibold" x-text="archetype.title"></h3>
                                </div>
                                <p class="text-slate-600 mb-4 font-medium">Desafío: <span class="font-normal" x-text="archetype.challenge"></span></p>
                                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg">
                                    <h4 class="font-bold text-blue-800">Solución Estratégica</h4>
                                    <p class="text-blue-700 mt-1" x-text="archetype.solution"></p>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </section>

            <!-- Section: Herramientas -->
            <section id="herramientas" class="mb-16 scroll-mt-20">
                <h2 class="text-3xl font-bold text-slate-900 mb-2">Comparador de Herramientas de Gestión</h2>
                <p class="text-lg text-slate-600 mb-8 max-w-3xl">La automatización es una necesidad, no un lujo. Compare las principales plataformas todo-en-uno para encontrar la que mejor se adapte a sus necesidades. Seleccione las herramientas para comparar.</p>
                <div class="flex flex-col lg:flex-row gap-8">
                    <div class="lg:w-2/3 bg-white p-6 rounded-lg shadow">
                        <div class="chart-container h-96 md:h-[450px]">
                            <canvas id="toolsRadarChart"></canvas>
                        </div>
                    </div>
                    <div class="lg:w-1/3">
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h3 class="text-xl font-semibold mb-4">Seleccionar Herramientas</h3>
                            <div class="space-y-3">
                                <template x-for="tool in softwareTools" :key="tool.name">
                                    <label class="flex items-center p-3 rounded-md hover:bg-slate-50 cursor-pointer">
                                        <input type="checkbox" :value="tool.name" x-model="selectedTools" @change="updateRadarChart()" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                        <span class="ml-3 text-slate-700 font-medium" x-text="tool.name"></span>
                                    </label>
                                </template>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow mt-6">
                             <h3 class="text-xl font-semibold mb-2">Diferenciador Clave</h3>
                             <template x-for="tool in softwareTools" :key="tool.name">
                                <div x-show="selectedTools.includes(tool.name)" class="mt-2 text-sm">
                                    <p><span class="font-bold" x-text="tool.name + ': '"></span><span x-text="tool.differentiator"></span></p>
                                </div>
                             </template>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Politica -->
            <section id="politica" class="mb-16 scroll-mt-20">
                <h2 class="text-3xl font-bold text-slate-900 mb-2">Generador de Políticas de Gasto</h2>
                <p class="text-lg text-slate-600 mb-8 max-w-3xl">Una política clara es la base de la disciplina financiera. Utilice esta herramienta interactiva para definir y visualizar su matriz de aprobación.</p>
                <div class="flex flex-col lg:flex-row gap-8">
                    <div class="lg:w-1/2 bg-white p-8 rounded-lg shadow">
                        <h3 class="text-xl font-semibold mb-6">Configure sus Umbrales de Aprobación</h3>
                        <div class="space-y-8">
                            <div>
                                <label for="limit1" class="font-medium">Gasto estándar (Aprobador: Jefe de Depto.)</label>
                                <input type="range" id="limit1" min="250" max="5000" step="50" x-model.number="approvalMatrix[1].amount" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer mt-2">
                                <div class="flex justify-between text-sm text-slate-500 mt-1">
                                    <span>$250</span>
                                    <span class="font-bold text-blue-600" x-text="'$' + approvalMatrix[1].amount"></span>
                                    <span>$5,000</span>
                                </div>
                            </div>
                            <div>
                                <label for="limit2" class="font-medium">Gasto importante (Aprobadores: Jefe de Depto. + Finanzas)</label>
                                <input type="range" id="limit2" min="5000" max="20000" step="100" x-model.number="approvalMatrix[2].amount" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer mt-2">
                                <div class="flex justify-between text-sm text-slate-500 mt-1">
                                    <span>$5,000</span>
                                    <span class="font-bold text-blue-600" x-text="'$' + approvalMatrix[2].amount"></span>
                                    <span>$20,000</span>
                                </div>
                            </div>
                        </div>
                        <div class="mt-10 bg-slate-50 p-4 rounded-md border border-slate-200">
                            <h4 class="font-semibold text-lg mb-2">Resumen de la Política</h4>
                            <ul class="list-disc list-inside text-slate-700 space-y-1">
                                <li>Gastos hasta <strong class="text-blue-600" x-text="'$' + (approvalMatrix[1].amount - 1)"></strong> requieren solo recibo.</li>
                                <li>Gastos desde <strong class="text-blue-600" x-text="'$' + approvalMatrix[1].amount"></strong> hasta <strong class="text-blue-600" x-text="'$' + (approvalMatrix[2].amount - 1)"></strong> requieren aprobación del Jefe de Departamento.</li>
                                <li>Gastos de <strong class="text-blue-600" x-text="'$' + approvalMatrix[2].amount"></strong> o más requieren aprobación del Jefe de Depto. y Finanzas.</li>
                                <li>Gastos superiores a <strong class="text-blue-600">$20,000</strong> requieren aprobación del CEO.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="lg:w-1/2 bg-white p-6 rounded-lg shadow">
                         <div class="chart-container h-96 md:h-[450px]">
                            <canvas id="policyChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Implementacion -->
            <section id="implementacion" class="scroll-mt-20">
                <h2 class="text-3xl font-bold text-slate-900 mb-2">Hoja de Ruta de Implementación</h2>
                <p class="text-lg text-slate-600 mb-8 max-w-3xl">Un despliegue por fases es una estrategia inteligente para garantizar el éxito. Siga esta hoja de ruta para pasar del plan a la práctica.</p>
                <div class="relative border-l-2 border-blue-500 ml-4 py-4">
                    <template x-for="(phase, index) in implementationPlan" :key="index">
                        <div class="mb-8 ml-8">
                            <span class="absolute -left-4 flex items-center justify-center w-8 h-8 bg-blue-100 rounded-full ring-8 ring-white">
                                <i :data-lucide="phase.icon" class="w-5 h-5 text-blue-600"></i>
                            </span>
                            <h3 class="text-xl font-semibold text-slate-900" x-text="phase.title"></h3>
                            <time class="block mb-2 text-sm font-normal leading-none text-slate-500" x-text="phase.duration"></time>
                            <ul class="list-disc list-inside text-slate-600 space-y-1">
                                <template x-for="task in phase.tasks" :key="task">
                                    <li x-text="task"></li>
                                </template>
                            </ul>
                        </div>
                    </template>
                </div>
            </section>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script>
        function appData() {
            let radarChart = null;
            let policyChart = null;

            return {
                activeSection: 'filosofia',
                activeStep: null,
                p2pSteps: [
                    { title: 'ID Necesidad y Solicitud', description: 'El Jefe de Departamento identifica una necesidad y crea una Solicitud de Compra (SC) digital, detallando qué, porqué, cuánto y de quién.', raci: { solicitante: 'R', finanzas: 'I', gestor: 'C', ceo: 'I' } },
                    { title: 'Aprobación de Solicitud', description: 'La SC se enruta para su aprobación según la matriz de umbrales. Este es el principal punto de control financiero.', raci: { solicitante: 'I', finanzas: 'A/R', gestor: 'C', ceo: 'A' } },
                    { title: 'Incorporación de Proveedor', description: 'Para nuevos proveedores, se recopila y centraliza la información fiscal y de pago para prevenir fraudes y agilizar procesos.', raci: { solicitante: 'C', finanzas: 'R', gestor: 'A', ceo: 'I' } },
                    { title: 'Creación de Orden de Compra (OC)', description: 'Una vez aprobada la SC, se genera una OC formal. Es un documento legalmente vinculante que autoriza la compra.', raci: { solicitante: 'I', finanzas: 'R', gestor: 'A', ceo: 'I' } },
                    { title: 'Recepción de Bienes/Servicios', description: 'El solicitante confirma que lo recibido coincide con lo pedido en calidad y cantidad, evitando pagos por pedidos incorrectos.', raci: { solicitante: 'R', finanzas: 'I', gestor: 'I', ceo: 'I' } },
                    { title: 'Recepción y Proceso de Factura', description: 'El proveedor envía la factura, idealmente en formato electrónico. Finanzas la recibe y registra en el sistema.', raci: { solicitante: 'I', finanzas: 'R', gestor: 'I', ceo: 'I' } },
                    { title: 'Cotejo y Aprobación de Factura', description: 'El sistema verifica que la Factura coincida con la OC y la Nota de Recepción (Cotejo de 3 vías), asegurando pagar lo correcto.', raci: { solicitante: 'C', finanzas: 'R', gestor: 'A', ceo: 'I' } },
                    { title: 'Ejecución del Pago', description: 'Una vez aprobada la factura, Finanzas programa el pago según los términos acordados, cerrando el ciclo P2P.', raci: { solicitante: 'I', finanzas: 'R', gestor: 'A', ceo: 'I' } }
                ],
                archetypes: [
                    { id: 1, icon: 'megaphone', title: 'Marketing', challenge: 'Gasto dinámico y recurrente en SaaS y publicidad (Google/Meta) donde las OCs son demasiado lentas.', solution: 'Asignar presupuestos y usar tarjetas virtuales por proveedor para control granular, seguridad y visibilidad en tiempo real.' },
                    { id: 2, icon: 'briefcase', title: 'Contratación', challenge: 'Pagos a freelancers (Upwork) que implican contratos y verificación de servicios, no de bienes físicos.', solution: 'Usar OCs basadas en servicios (con un SOW adjunto) para alinear el pago con los entregables acordados.' },
                    { id: 3, icon: 'truck', title: 'Operaciones', challenge: 'Necesidades impredecibles, desde material de oficina rutinario hasta reparaciones de emergencia o servicios puntuales.', solution: 'Usar tarjetas corporativas con límite para gastos menores y el flujo P2P completo para compras de alto valor.' }
                ],
                softwareTools: [
                    { name: 'Ramp', scores: [4, 5, 5, 4, 5], differentiator: 'Perspectivas de ahorro impulsadas por IA y automatización.' },
                    { name: 'Brex', scores: [3, 5, 4, 5, 4], differentiator: 'Solución financiera global todo en uno (banca, tarjetas, etc.).' },
                    { name: 'Airbase', scores: [5, 4, 3, 4, 3], differentiator: 'Fuerte automatización del proceso P2P y cuentas por pagar (AP).' },
                    { name: 'Spendesk', scores: [4, 4, 3, 3, 4], differentiator: 'Sólido soporte multi-entidad para Europa.' }
                ],
                selectedTools: ['Ramp', 'Brex'],
                approvalMatrix: [
                    { level: 'Básico', amount: 250, approver: 'Ninguno (recibo)' },
                    { level: 'Estándar', amount: 2500, approver: 'Jefe de Depto.' },
                    { level: 'Importante', amount: 10000, approver: 'Jefe de Depto. + Finanzas' },
                    { level: 'Estratégico', amount: 10001, approver: 'Jefe de Depto. + Finanzas + CEO' }
                ],
                implementationPlan: [
                    { title: 'Fase 1: Fundación y Alineación', duration: 'Semanas 1-2', icon: 'flag', tasks: ['Obtener apoyo ejecutivo', 'Finalizar la política de gastos de forma colaborativa', 'Seleccionar y adquirir el software de gestión'] },
                    { title: 'Fase 2: Configuración y Piloto', duration: 'Semanas 3-5', icon: 'settings-2', tasks: ['Configurar la plataforma (usuarios, flujos)', 'Lanzar un programa piloto con un departamento', 'Desarrollar materiales de capacitación basados en el piloto'] },
                    { title: 'Fase 3: Capacitación y Despliegue', duration: 'Semanas 6-7', icon: 'users', tasks: ['Lanzar campaña de comunicación interna (el "porqué")', 'Realizar sesiones de capacitación obligatorias y prácticas', 'Puesta en marcha oficial con soporte intensivo'] },
                    { title: 'Fase 4: Monitoreo e Iteración', duration: 'Continuo', icon: 'trending-up', tasks: ['Monitorear KPIs (eficiencia, cumplimiento, precisión)', 'Recopilar feedback de los usuarios', 'Realizar ajustes al proceso usando el ciclo OODA'] }
                ],

                init() {
                    lucide.createIcons();
                    this.initRadarChart();
                    this.initPolicyChart();

                    this.$watch('approvalMatrix', () => {
                        this.updatePolicyChart();
                    }, { deep: true });
                    
                    // Simple scroll spy
                    const sections = document.querySelectorAll('section');
                    const observer = new IntersectionObserver(entries => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                this.activeSection = entry.target.id;
                            }
                        });
                    }, { rootMargin: "-50% 0px -50% 0px" });
                    sections.forEach(section => observer.observe(section));
                },

                raciColor(role) {
                    if (!role) return '';
                    const roleInitial = role.charAt(0).toUpperCase();
                    switch (roleInitial) {
                        case 'R': return 'text-green-600';
                        case 'A': return 'text-blue-600';
                        case 'C': return 'text-yellow-600';
                        case 'I': return 'text-slate-500';
                        default: return 'text-slate-500';
                    }
                },

                updateRadarChart() {
                    if (!radarChart) return;
                    const datasets = this.softwareTools
                        .filter(tool => this.selectedTools.includes(tool.name))
                        .map(tool => ({
                            label: tool.name,
                            data: tool.scores,
                            fill: true,
                            borderWidth: 2,
                        }));
                    radarChart.data.datasets = datasets;
                    radarChart.update();
                },
                
                initRadarChart() {
                    const ctx = document.getElementById('toolsRadarChart').getContext('2d');
                    const chartData = {
                        labels: ['Funcionalidad P2P', 'Gestión de Tarjetas', 'Automatización', 'Integración Contable', 'Experiencia de Usuario (UX)'],
                        datasets: []
                    };
                    radarChart = new Chart(ctx, {
                        type: 'radar',
                        data: chartData,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'top' },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            let label = context.dataset.label || '';
                                            if (label) { label += ': '; }
                                            if (context.parsed.r !== null) {
                                                label += context.parsed.r + ' / 5';
                                            }
                                            return label;
                                        }
                                    }
                                }
                            },
                            scales: {
                                r: {
                                    angleLines: { display: false },
                                    suggestedMin: 0,
                                    suggestedMax: 5,
                                    pointLabels: { font: { size: 12 } },
                                    ticks: { stepSize: 1 }
                                }
                            },
                        }
                    });
                    this.updateRadarChart();
                },
                
                updatePolicyChart() {
                    if (!policyChart) return;
                    const data = [
                        this.approvalMatrix[0].amount,
                        this.approvalMatrix[1].amount - this.approvalMatrix[0].amount,
                        this.approvalMatrix[2].amount - this.approvalMatrix[1].amount,
                        25000 - this.approvalMatrix[2].amount // Assuming a max of 25k for visualization
                    ];
                    policyChart.data.datasets[0].data = data;
                    policyChart.update();
                },

                initPolicyChart() {
                    const ctx = document.getElementById('policyChart').getContext('2d');
                    policyChart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Recibo', 'Jefe Depto.', 'Jefe Depto. + Finanzas', 'CEO'],
                            datasets: [{
                                label: 'Rango de Gasto ($)',
                                data: [],
                                backgroundColor: [
                                    'rgba(147, 197, 253, 0.6)',
                                    'rgba(59, 130, 246, 0.6)',
                                    'rgba(37, 99, 235, 0.6)',
                                    'rgba(30, 64, 175, 0.6)'
                                ],
                                borderColor: [
                                    'rgba(147, 197, 253, 1)',
                                    'rgba(59, 130, 246, 1)',
                                    'rgba(37, 99, 235, 1)',
                                    'rgba(30, 64, 175, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    stacked: true,
                                    ticks: {
                                        callback: function(value) { return '$' + value / 1000 + 'k'; }
                                    }
                                },
                                y: { stacked: true }
                            },
                            plugins: {
                                legend: { display: false },
                                title: { display: true, text: 'Visualización de Niveles de Aprobación' },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const lower = context.parsed._stacks.x[0] || 0;
                                            const upper = context.parsed._stacks.x[1];
                                            return `Rango: $${lower} - $${upper}`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                    this.updatePolicyChart();
                }
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Smooth scrolling for nav links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });
        });
    </script>
</body>
</html>
